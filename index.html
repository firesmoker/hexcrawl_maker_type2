<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HexGen | Pro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <aside class="sidebar">
        <div class="brand">
            <span>â¬¢</span> HexGen
        </div>

        <div class="control-group">
            <div class="control-label">
                Hex Size (Inch)
                <span id="hex-size-val" class="value-display">0.5"</span>
            </div>
            <div class="slider-container">
                <!-- 0.1 to 1.0 inches, step 0.05 -->
                <input type="range" id="hex-size" min="0.1" max="1.0" step="0.05" value="0.5">
            </div>
            <label class="checkbox-container mini-check">
                <input type="checkbox" id="auto-apply-hex" checked>
                <span class="checkmark"></span>
                Auto Apply
            </label>
        </div>

        <div class="control-group">
            <div class="control-label">
                Clustering
                <span id="clustering-val" class="value-display">80%</span>
            </div>
            <div class="slider-container">
                <input type="range" id="clustering" min="0" max="1.0" step="0.05" value="0.8">
            </div>
        </div>

        <div class="control-group">
            <div class="control-label">Terrain Types</div>
            <div class="terrain-options">
                <div class="terrain-row">
                    <input type="color" class="terrain-color-picker" data-terrain="sea" value="#4fc3f7"
                        title="Change Sea Color">
                    <label class="checkbox-container">
                        <input type="checkbox" name="terrain" value="sea" checked>
                        <span class="checkmark"></span>
                        Sea
                    </label>
                    <input type="range" class="terrain-weight" data-terrain="sea" min="1" max="100" value="10"
                        title="Probability Weight">
                    <span class="weight-val">10%</span>
                </div>
                <div class="terrain-row">
                    <input type="color" class="terrain-color-picker" data-terrain="plains" value="#aed581"
                        title="Change Plains Color">
                    <label class="checkbox-container">
                        <input type="checkbox" name="terrain" value="plains" checked>
                        <span class="checkmark"></span>
                        Plains
                    </label>
                    <input type="range" class="terrain-weight" data-terrain="plains" min="1" max="100" value="100"
                        title="Probability Weight">
                    <span class="weight-val">100%</span>
                </div>
                <div class="terrain-row">
                    <input type="color" class="terrain-color-picker" data-terrain="swamp" value="#6d4c41"
                        title="Change Swamp Color">
                    <label class="checkbox-container">
                        <input type="checkbox" name="terrain" value="swamp" checked>
                        <span class="checkmark"></span>
                        Swamp
                    </label>
                    <input type="range" class="terrain-weight" data-terrain="swamp" min="1" max="100" value="10"
                        title="Probability Weight">
                    <span class="weight-val">10%</span>
                </div>
                <div class="terrain-row">
                    <input type="color" class="terrain-color-picker" data-terrain="snow" value="#f5f5f5"
                        title="Change Snow Color">
                    <label class="checkbox-container">
                        <input type="checkbox" name="terrain" value="snow" checked>
                        <span class="checkmark"></span>
                        Snow
                    </label>
                    <input type="range" class="terrain-weight" data-terrain="snow" min="1" max="100" value="10"
                        title="Probability Weight">
                    <span class="weight-val">10%</span>
                </div>
                <div class="terrain-row">
                    <input type="color" class="terrain-color-picker" data-terrain="desert" value="#fff59d"
                        title="Change Desert Color">
                    <label class="checkbox-container">
                        <input type="checkbox" name="terrain" value="desert" checked>
                        <span class="checkmark"></span>
                        Desert
                    </label>
                    <input type="range" class="terrain-weight" data-terrain="desert" min="1" max="100" value="20"
                        title="Probability Weight">
                    <span class="weight-val">20%</span>
                </div>
                <div class="terrain-row">
                    <input type="color" class="terrain-color-picker" data-terrain="wasteland" value="#78909c"
                        title="Change Wasteland Color">
                    <label class="checkbox-container">
                        <input type="checkbox" name="terrain" value="wasteland" checked>
                        <span class="checkmark"></span>
                        Wasteland
                    </label>
                    <input type="range" class="terrain-weight" data-terrain="wasteland" min="1" max="100" value="10"
                        title="Probability Weight">
                    <span class="weight-val">10%</span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <div class="control-label">Map Tools</div>
            <div class="tool-buttons">
                <button id="tool-select" class="tool-btn active" title="Select / Edit (Click & Drag)">
                    <svg viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor" d="M7 2l12 11.2-5.8.5 3.3 7.3-2.2.9-3.2-7.4-4.4 4V2z" />
                    </svg>
                    <span>Select</span>
                </button>
                <button id="tool-road" class="tool-btn" title="Paint Road (Drag)">
                    <svg viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor"
                            d="M18,4C13.5,4 9,8.5 9,13C9,17.5 4.5,22 0,22V20C3.5,20 7,16.5 7,13C7,9.5 11.5,5 16,5V4M18,2V4C22.5,4 27,8.5 27,13C27,17.5 22.5,22 18,22V20C21.5,20 25,16.5 25,13C25,9.5 20.5,5 16,5V2H18Z"
                            transform="translate(-2,-2) scale(1.1)" />
                        <!-- Simple dashed path representation -->
                        <path d="M4 20 L20 4" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2"
                            fill="none" />
                    </svg>
                    <span>Road</span>
                </button>
                <button id="tool-river" class="tool-btn" title="Paint River (Drag)">
                    <svg viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor"
                            d="M19.38 10.32C18.67 9.85 17.65 9.85 16.94 10.32L15.35 11.38C14.64 11.85 13.62 11.85 12.91 11.38L11.32 10.32C10.61 9.85 9.59 9.85 8.88 10.32L7.29 11.38C6.58 11.85 5.54 11.85 4.83 11.38L2 9.5V14.5L4.83 16.38C5.54 16.85 6.58 16.85 7.29 16.38L8.88 15.32C9.59 14.85 10.61 14.85 11.32 15.32L12.91 16.38C13.62 16.85 14.64 16.85 15.35 16.38L16.94 15.32C17.65 14.85 18.67 14.85 19.38 15.32L22 17.06V12.06L19.38 10.32Z" />
                    </svg>
                    <span>River</span>
                </button>
            </div>
        </div>

        <button id="btn-generate" class="btn-generate">Generate Grid</button>
    </aside>

    <main class="main-content">
        <div class="vertical-zoom-widget">
            <svg class="zoom-icon" viewBox="0 0 24 24" width="20" height="20">
                <path fill="currentColor"
                    d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
            </svg>
            <input type="range" id="zoom-level" min="0.2" max="2.0" step="0.1" value="0.6" orient="vertical">
            <span id="zoom-level-val" class="zoom-value">100%</span>
        </div>
        <div id="page-wrapper">
            <div class="page-container" id="page-container">
                <svg id="hex-grid" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <!-- Heavy filter for rivers -->
                        <filter id="rough-river" x="-20%" y="-20%" width="140%" height="140%">
                            <feTurbulence type="fractalNoise" baseFrequency="0.04" numOctaves="3" result="noise" />
                            <feDisplacementMap in="SourceGraphic" in2="noise" scale="12" xChannelSelector="R"
                                yChannelSelector="G" result="displaced" />
                            <feGaussianBlur in="displaced" stdDeviation="0.8" />
                        </filter>
                        <!-- Lighter filter for roads -->
                        <filter id="rough-road" x="-20%" y="-20%" width="140%" height="140%">
                            <feTurbulence type="fractalNoise" baseFrequency="0.02" numOctaves="3" result="noise" />
                            <feDisplacementMap in="SourceGraphic" in2="noise" scale="5" xChannelSelector="R"
                                yChannelSelector="G" result="displaced" />
                            <feGaussianBlur in="displaced" stdDeviation="0.9" />
                        </filter>
                        <!-- Glow for hovered hexes -->
                        <filter id="hex-hover-glow" x="-50%" y="-50%" width="200%" height="200%">
                            <feDropShadow dx="0" dy="0" stdDeviation="5" flood-color="black" flood-opacity="0.5" />
                        </filter>
                    </defs>
                    <g id="hex-layer"></g>
                    <g id="path-layer"></g>
                    <g id="addon-layer"></g>
                    <g id="highlight-layer" pointer-events="none"></g>
                </svg>
            </div>
        </div>
    </main>

    <aside class="right-panel">
        <div class="brand">Settings & Actions</div>

        <div class="control-group">
            <div class="control-label">File Operations</div>
            <button id="btn-download" class="btn-download">Download PNG</button>
            <div class="side-actions">
                <button id="btn-export" class="btn-download">Export CSV</button>
                <button id="btn-import" class="btn-download">Import CSV</button>
                <input type="file" id="csv-upload" accept=".csv" style="display:none">
            </div>
        </div>

        <div class="control-group">
            <div class="control-label">Edit History</div>
            <div class="history-actions">
                <button id="btn-undo" class="btn-history" title="Undo (Ctrl+Z)" disabled>
                    <svg viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor"
                            d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8Z" />
                    </svg>
                    Undo
                </button>
                <button id="btn-redo" class="btn-history" title="Redo (Ctrl+Y)" disabled>
                    <svg viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor"
                            d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6Z" />
                    </svg>
                    Redo
                </button>
            </div>
        </div>
    </aside>

    <!-- Context Menu / Popup moved to body level -->
    <div id="hex-popup" class="hex-popup hidden">
        <div class="popup-title" id="popup-title">Edit Hex</div>
        <button id="btn-show-addons" class="btn-add-ons">+ Add...</button>
        <button id="btn-remove-addon" class="btn-remove-addon hidden">Remove</button>
        <div class="addon-label-group" id="addon-label-container">
            <div class="label-hint">Label</div>
            <input type="text" id="hex-label-input" placeholder="Custom label...">
        </div>
        <button id="btn-select-cluster" class="btn-cluster">Select Cluster</button>
        <div class="popup-options" id="popup-options">
            <!-- Terrain options injected via JS -->
        </div>
    </div>

    <div id="addon-popup" class="hex-popup hidden">
        <div class="popup-title">Select Add-on</div>
        <div id="addon-list" class="addon-list">
            <!-- Addons injected via JS -->
        </div>
    </div>

    <div id="path-popup" class="hex-popup hidden">
        <div class="popup-title" id="path-popup-title">Selected Path</div>
        <div class="popup-options">
            <button id="btn-delete-path" class="btn-cluster" style="border-color: #ff5252; color: #ff5252;">Remove
                Path</button>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>

</html>